#summary Protocol used for communicating with the thermostat
#labels Featured,Phase-Implementation

= Heatmiser V3 System Protocol =

Heatmiser !WiFi thermostats expose two interfaces accessible via TCP/IP: an embedded web server running on port 80, and an "iPhone" interface on port 8068. The latter interface is used by this software. It is a variant of the Heatmiser V3 System Protocol, running over TCP/IP rather than a serial link. For the RS485 variant of the protocol see Neil Trimboy's [http://code.google.com/p/heatmiser-monitor-control heatmiser-monitor-control] project.

[http://www.heatmiser.co.uk/web/index.php/docs/viewcategory/14-custom-integration Heatmiser V3 System Protocol documentation (version V3.1)]

== Documentation Errors ==

There are a few errors and ambiguities in Heatmiser's documentation, mainly in the details of the "DCB structure" that provides the thermostat's configuration and status. The correct details were determined by analysing the data returned by a PRT-TS WiFi thermostat. There are presumably similar errors in the documentation for other models.
 * When multi-octet values are read (notably the length and temperature measurements) the less significant octet appears first. For all such values, except the DCB length field, the more significant octet appears at the address stated in the documentation with the less significant octet at the preceding address.
 * The switching differential is specified as being in the range 1-3, but is actually in the range 1-6 in units of 0.5Â°C.
 * The holiday field is shown as a two-octet value in hours at address 24, but is actually 6 octets long (year, month, day of month, hour, minute, and an enabled flag) starting at address 25.
 * The addresses specified for all fields after the holiday return date are incorrect. The error code is at address 39, current heating state at address 40, the current date and time starts at address 41, and the program starts at address 48.

Corrections for other models (DT-TS !WiFi, PRT/HW-TS !WiFi and TM1-TS !WiFi) will be gratefully received.